# 라우팅과 인터넷 계층
*written by sohyeon, hyemin 💡*

<br>

- - -

## 1. 인터넷 계층의 역할

<img src="./resources/internetLayer.PNG" width="400px">

`인터넷 계층`은 네트워크 인터페이스 계층과 협력하여 다른 컴퓨터에게 데이터를 전달하는 역할을 한다.  

하드웨어에 의존해야 하는 부분은 네트워크 인터페이스 계층이 담당하고  
인터넷 계층은 `IP 어드레스`라고 하는 식별자 정보를 실마리로 데이터를 전달할 수 있는 체계를 제공한다.  

## 1) 라우터와 라우팅

* 라우터 : 데이터를 목적지까지 전달할 수 있도록 도와주는 네트워크 장비
           네트워크와 네트워크를 연결하는 역할을 함

* 라우팅 : 데이터가 최종 목적지에 도달할 수 있도록 라우터가 경로를 찾아가는과정

## 2. IPv4와 IPv6

둘 다 인터넷 계층에서 사용되는 중요한 프로토콜로  
IP 어드레스를 결정할 때 사용하는 비트의 길이가 서로 다르다.

## 1) IPv4

현재까지 컴퓨터 어드레스 지정에 가장 많이 사용되는 인터넷 계층의 프로토콜이다.  
`32비트`의 IP어드레스가 사용된다.

전체 32비트를 8비트씩 4개 단위로 끊은 후 10진수로 변환해 표기한다.  

    ex) 192.168.100.1

### ● IPv4 패킷

<img src="./resources/IPv4packet.PNG" width="500px">

- 서비스 타입 : 패킷의 우선 순위를 결정
- 프로토콜 : 트랜스포트 계층의 어느 프로토콜에 전달할지를 판단하는 번호 부분
- 생존 기간 : 생존 기간 정보를 설정 가능하고, 
             만약 생존 기간을 초과한 패킷이 네트워크상에서 발견되면 그 패킷을 소멸하도록 규정하고 있다.  

### ● MTU (Maximum Trasmission Unit)

한번에 전송할 수 있는 데이터 크기를 의미한다.  

라우터가 데이터를 송신하기 전 통신 경로 전체의 MTU를 살펴본 후  
MTU보다 작은 크기의 패킷을 만들도록 설정해 데이터 유실을 방지하기도 한다.  

패킷을 분할, 복원하는 작업을 위해 헤더에 다양한 필드가 존재한다.

- 식별자 : 같은 데이터인지 식별
- 분할 플래그 : 분할 허가 플래그와 이후 남은 분할 부분이 더 있는지 표시
- 프래그먼트 옵셋 : 원래 데이터에서의 위치 값을 표현

식별자나 IP 어드레스 정보 들을 보고 분할된 조각을 모아서 복원하게 된다.  

## 2) IPv6

인터넷의 급격한 성장으로 인해 IPv4의 32비트 어드레스가 머지않아 고갈될 상황에 이르렀다.  
이를 방지하기 위해 128비트 어드레스로 만든 IPv6의 보급이 가속화 되고 있다.  

    IPv4의 생명을 연장할 수 있는 기술들도 나오고 있어 당분간은 IPv4와 IPv6를 병행해서 사용하게 될 것으로 보인다.  

### ● IPv6 패킷

<img src="./resources/IPv4packet.PNG" width="500px">

- 트래픽 클래스 : 패킷의 우선순위를 결정
- 페이로드의 길이 : 데이터 부분의 길이
- 홉 리미트 : IPv4의 생존 기간과 같은 역할
- 확장 헤더 : 옵션 설정

    - IPv6는 라우터에서 데이터를 분할하지 않는 방식으로 사양이 만들어져 있어서
      분할 관련 필드는 옵션으로 되어 있다.

## 3) 터널링과 듀얼 스택

IPv4와 IPv6는 어드레스나 패킷 어느 것으로도 서로 호환이 되지 않는다.  
두 가지를 병행할 수 있도록 `터널링`과 `듀얼 스택`이라는 기법을 사용할 수 있다.

- 터널링 : IPv4 네트워크를 IPv6 패킷이 지나가야 한다면,
           IPv4 패킷 안에 IPv6 패킷을 넣어서 보내는 방법이다.  

- 듀얼 스택 : 하나의 장비에 두 종류의 어드레스를 모두 할당한 후 둘 다 사용 가능하도록 한다.  

